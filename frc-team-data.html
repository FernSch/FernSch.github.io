<!DOCTYPE html>
<html>  
<head>
	<title>FRC Team Data Card Generator</title>
	<link rel="stylesheet" href="style.css">
	<script>
		function generateCard() {
			var team_num = document.getElementById("team_num_data").value;
				fetch(api_url)
				.then(response => response.json())
				.then(data => {
					if (data.team_number === undefined) {
						alert("Please enter a valid team number!");
					} else {
						var canvas = document.getElementById("myCanvas");
						canvas.height = 300;
						canvas.width = 900;
							var ctx = canvas.getContext("2d");

						// Generate random pastel color
						var hue = Math.floor(Math.random() * 360);
						var pastel = 'hsl(' + hue + ', 100%, 85%)';

						ctx.fillStyle = pastel;
						ctx.fillRect(0, 0, canvas.width, canvas.height);

						ctx.fillStyle = "black";
						ctx.font = "50px Arial";
						ctx.fillText(data.nickname, 50, 75);

						ctx.font = "bold 70px Arial";
						ctx.fillText(data.team_number, 50, 160);

						ctx.font = "italic 30px Arial";
						ctx.fillText(data.country, 50, 220);

						ctx.font = "30px Arial";
						ctx.fillText("Rookie Year: " + data.rookie_year, 50, 270);

						var winrate = (data.wins + data.ties/2) / (data.wins + data.losses + data.ties);
						if (isNaN(winrate)) {
							winrate = "N/A";
						} else {
							winrate = winrate.toFixed(3);
						}
						ctx.font = "30px Arial";
						ctx.fillText("Full Win Rate: " + winrate, 50, 300);

						var img = canvas.toDataURL("image/png");

						document.getElementById("card_image").src = img;
					}
				})
				.catch(error => console.error(error));
		}
	</script>
</head>
<body>
	<div class="container">
		<h1>FRC Team Data Card Generator</h1>
		<h2>Generate a Data card for an FRC team, based on statbotics</h2>

		<form>
			<label for="team_num_data">Team Number:</label>
			<input type="number" id="team_num_data" name="team_num_data" min="1" max="9999">
			<br><br>
			<button type="button" onClick="generateCard()">Generate Card</button>
		</form>

		<br>

		<img id="card_image" alt="Generated Team Data Card">
	</div>

	<canvas id="myCanvas"></canvas>
</body>
</html>
